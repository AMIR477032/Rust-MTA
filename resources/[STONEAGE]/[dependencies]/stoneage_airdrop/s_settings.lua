-- LuaFormatter off
local spawnLocations = {
    {-271.77621,1129.4624,19.59375},
    {-299.31583,1305.6277,53.813847},
    {-289.27271,1478.0084,75.655434},
    {356.24658,2017.2867,22.640625},
    {205.3638,1932.7667,23.242188},
    {172.12035,1232.7968,23.190592},
    {768.97156,1421.9778,19.804245},
    {683.2207,1830.6531,5.2476959},
    {845.49213,2630.4998,11.882915},
    {118.51002,2503.9409,16.484375},
    {414.24716,2497.5813,16.484375},
    {-713.90656,2062.3953,60.382813},
    {-913.85486,2014.4294,60.914063},
    {-1172.0876,2020.9219,134.689},
    {-1176.5677,1793.7423,40.424702},
    {-806.60834,1580.363,26.960938},
    {-890.04846,1524.2595,25.914063},
    {-752.07898,1449.6676,15.901578},
    {-954.67035,1179.6598,32.742901},
    {-642.57507,1005.7274,12.00494},
    {-767.66199,791.93634,15.682267},
    {619.93787,868.38812,-42.960937},
    {678.17627,969.27643,-12.687492},
    {624.38,749.53979,-13.248775},
    {497.58002,1181.049,8.6661768},
    {523.73145,1509.1558,1},
    {-721.80646,2401.3228,127.76646},
    {-1000.0338,2769.6147,46.495316},
    {-1429.6942,2734.2495,63.383656},
    {-1410.8186,2625.2327,55.6875},
    {-1517.9025,2476.0513,55.967545},
    {-1666.6699,2500.4631,87.172432},
    {-1933.0333,2356.8257,49.336884},
    {-2059.2554,2279.0737,16.521885},
    {-2226.9873,2325.9971,7.546875},
    {-2382.6616,2372.7329,3.4581666},
    {-2499.7771,2331.2405,4.8359375},
    {-2629.731,1358.2346,7.1005316},
    {-2893.405,1237.4913,7.1015625},
    {-2805.3271,1117.1206,28.26923},
    {-2636.5217,1230.6554,50.984779},
    {-2402.7654,1097.0988,55.790199},
    {-2573.3738,653.46234,27.8125},
    {-2446.7957,733.14874,35.015625},
    {-2679.7961,784.96014,49.984375},
    {-2665.7395,937.41376,79.710121},
    {-2893.7803,466.70804,4.9140625},
    {-2674.4238,234.70078,4.3359375},
    {-2509.165,258.349,35.171875},
    {-2770.8357,239.39763,7.1875},
    {-2664.238,-55.386967,4.3359375},
    {-2467.2222,-256.45956,39.53553},
    {-2319.5083,186.31104,35.3125},
    {-2213.9414,113.05825,35.320313},
    {-2080.033,244.6908,36.079926},
    {-2060.8997,21.523146,35.320313},
    {-1929.0806,251.59537,41.03907},
    {-1622.5416,391.74872,7.1875},
    {-1434.2141,498.90149,18.234375},
    {-1243.0533,446.09332,7.1875},
    {-1372.9312,494.31995,24.296875},
    {-1285.4795,115.85744,14.180624},
    {-1710.6243,-398.34131,14.148438},
    {-1171.8451,-473.05814,14.148438},
    {-1140.7429,-954.24976,129.21875},
    {-1352.5847,-1080.6688,161.19261},
    {-1057.2885,-1654.3585,77.092476},
    {-818.88336,-1255.9966,74.530693},
    {-875.8526,-783.30896,148.21875},
    {-562.49719,-1053.5496,23.87216},
    {-581.76855,-600.70184,21.15373},
    {-412.29211,-412.95093,16.4688},
    {-942.58319,-528.2843,25.953638},
    {-879.84229,-281.19693,62.743073},
    {-598.90942,-56.220638,63.794235},
    {-535.51581,90.377007,29.465242},
    {-59.56955,-12.74955,3.1171875},
    {207.39726,70.088638,3.0089059},
    {290.68713,-20.239191,2.4481363},
    {206.53253,-173.47418,1.578125},
    {638.42029,-265.9964,8.1439648},
    {496.98273,102.6981,28.01572},
    {768.49829,72.047768,68.881134},
    {1045.6888,-37.558578,87.178772},
    {758.36102,-620.05115,15.265011},
    {643.32135,-501.55173,16.335938},
    {861.96429,-548.0097,18.97571},
    {1053.6362,-322.87845,73.985054},
    {948.8399,385.97913,19.882813},
    {1170.3771,533.27386,20.087387},
    {1371.569,463.5314,19.993879},
    {1341.0945,285.5722,19.561453},
    {1328.4901,215.92519,23.94095},
    {1242.7242,299.25388,28.755514},
    {1321.0565,-70.9198,36.176456},
    {1473.2418,-305.81329,3.4858665},
    {1664.264,-102.366,35.378998},
    {1558.6842,-6.7459612,22.32222},
    {1873.6892,184.52373,34.046646},
    {2082.1467,90.937889,28.785355},
    {2114.2903,260.60379,17.644531},
    {2250.061,126.11018,27.673393},
    {2467.8613,-32.790546,26.484375},
    {2554.0657,115.95315,25.692398},
    {2829.0437,44.059242,27.665319},
    {2600.4741,-281.61185,45.77943},
    {2439.0986,-296.98102,21.567791},
    {2225.261,-439.05469,116.90565},
    {2450.0244,-785.95782,110.22166},
    {2624.7058,-941.50604,79.208},
    {2888.4377,-765.91302,10.835938},
    {3112.3228,-568.37927,8.8765621},
    {3186.5369,-713.46692,8.8804264},
    {2856.3271,-1238.7872,22.490589},
    {2938.5117,-2051.3787,3.5480433},
    {2714.4868,-2049.739,13.41983},
    {2527.595,-1780.5619,13.382813},
    {2366.9558,-2309.7109,13.541326},
    {2265.2397,-2698.3711,13.545897},
    {2493.6284,-2572.3743,13.648438},
    {2834.7446,-2530.5798,17.94702},
    {2466.8191,-2259.3276,25.0625},
    {1899.0315,-2430.8818,13.539118},
    {1625.5454,-2615.2581,13.546875},
    {2136.2615,-2427.5471,13.546875},
    {1554.8962,-2315.5991,13.541882},
    {1377.0219,-2603.6357,13.546875},
    {1159.4873,-2369.6165,11.933809},
    {1481.7482,-2049.2837,31.107275},
    {1597.8101,-1965.549,31.344334},
    {1796.9172,-2046.562,13.559755},
    {1897.558,-2053.2007,13.382813},
    {2145.0464,-2061.8037,13.554371},
    {2439.9517,-2008.2343,13.421908},
    {2584.7161,-1996.5817,3.859375},
    {2468.0422,-2161.1145,13.672451},
    {1151.5222,-2138.2527,69.104546},
    {1162.3096,-2031.1024,69.00061},
    {1113.174,-2016.3578,74.429688},
    {1253.8701,-1916.2175,30.788364},
    {988.96063,-2108.6885,13.09375},
    {418.87814,-2477.1448,23.232519},
    {337.09958,-2444.7651,10.968231},
    {785.60828,-3635.6484,2.0684242},
    {827.29431,-3789.0242,1.1715674},
    {1042.333,-3632.0569,29.946569},
    {397.66336,-1864.5775,13.601563},
    {197.78017,-1839.0903,3.7137866},
    {152.56407,-1931.4019,3.7696438},
    {305.14001,-1718.167,6.9413013},
    {91.184837,-1563.6273,7.7483692},
    {-67.013634,-1394.2058,11.85412},
    {192.96445,-1044.4442,62.460125},
    {307.54465,-679.25793,5.8886299},
    {-275.24475,-876.8963,45.91444},
    {-395.93359,-1110.4064,67.545296},
    {-375.97736,-1470.411,25.726563},
    {-487.67709,-1669.3096,11.836824},
    {-438.14676,-1902.1614,5.9880524},
    {-271.3685,-1863.9316,23.697355},
    {-537.33752,-1963.533,49.844589},
    {-725.23755,-1857.7219,13.807625},
    {-761.88165,-2137.4436,25.643677},
    {-459.44806,-2429.8389,112.60493},
    {-173.51057,-2502.1189,29.205208},
    {-13.86696,-2510.1235,36.655464},
    {-167.46463,-2815.5852,41.380756},
    {-90.400307,-2767.0205,70.782104},
    {-455.69635,-2661.4385,156.98534},
    {-826.1803,-2543.0674,88.352707},
    {-932.20026,-2723.104,117.24611},
    {-1095.0502,-2615.4153,87.618698},
    {-1193.3843,-2487.6328,61.371552},
    {-1073.7238,-2294.3674,50.206146},
    {-775.39496,-2432.6812,69.850571},
    {-1151.3472,-1898.0601,78.004547},
    {-1432.0182,-1778.4574,48.010017},
    {-1788.3408,-1591.7985,21.75},
    {-1926.1698,-1511.946,25.323296},
    {-1773.3551,-1909.7317,95.322601},
    {-1531.1307,-2032.2666,50.870678},
    {-1334.7322,-2097.407,27.863472},
    {-1322.4994,-2287.9226,36.552212},
    {-1449.0323,-2579.9487,68.081177},
    {-1795.572,-2643.0647,53.145611},
    {-1821.1974,-2362.0879,32.167282},
    {-2076.9478,-2289.4102,30.46875},
    {-2136.7478,-2539.593,30.625},
    {-2182.0107,-2433.5312,35.523438},
    {-2518.5642,-2218.571,29.078484},
    {-2758.0793,-709.55396,39.483585},
    {-2471.7053,-608.58752,132.71094},
    {-2400.8469,-740.57086,133.12685},
    {-111.97264,912.48712,20.205973},
    {151.11807,1672.744,17.498108},
    {-155.84302,2376.6406,52.095406},
    {-226.97403,2596.9399,62.703125},
    {-300.20917,2727.6787,62.324371},
    {-130.1263,2747.9954,68.983376},
    {-142.36563,2001.9309,30.181297},
    {-318.36951,1842.4772,42.359375},
    {-499.54337,1697.3885,82.770073},
    {1468.213,635.46167,10.820313},
    {2833.6064,775.0108,10.898438},
    {2864.689,1142.5347,10.898438},
    {2802.6699,1308.5648,10.75},
    {2898.312,1809.0325,10.820313},
    {2911.7317,2465.853,10.820313},
    {2768.2632,2868.9153,10.820313},
    {2325.3403,2864.1169,11.183092},
    {2619.385,2759.7178,23.82222},
    {2508.311,2725.1128,10.820313},
    {2016.689,2914.9424,51.662155},
    {1766.6639,2776.2654,10.835938},
    {1570.6444,2820.9451,10.679672},
    {1381.8221,2821.5767,10.820313},
    {1215.3624,2760.4456,10.828125},
    {1003.2523,2637.5317,10.820313},
}
-- LuaFormatter on

getNearestPosition = function(x, y, z)
    local nearestX, nearestY, nearestZ = x, y, z
    local nearestDist = 999999999
    for k, v in ipairs(spawnLocations) do
        local dist = getDistanceBetweenPoints3D(x, y, z, unpack(v))
        if (dist <= nearestDist) then
            nearestDist = dist
            nearestX, nearestY, nearestZ = unpack(v)
        end
    end
    return nearestX, nearestY, nearestZ
end

function getRandomPoint()
    local n = math.random(#spawnLocations)
    local x, y, z = unpack(spawnLocations[n])
    return x, y, z
end

-- LuaFormatter off
local POSSIBLE_LOOTS = {
    ['LOOT++'] = {
        {'M249', 35},
        {'AK', 50},
        {'AK Ammo:BLUEPRINT', 4},
        {'AK:BLUEPRINT', 4},
        {'LR-300', 15},
        {'Bolt', 30},
        {'Custom SMG', 15},
        {'MP5', 20},
        {'Thompson', 20},
        {'Spas', 20},
        {'M39', 40},
        {'L96', 50},
        {'Camera', 15},
        {'Revolver', 10},
        {'Scrap Metal', 30},
        {'Vest', 15},
        {'Helmet', 15},
        {'Radial', 10},
        {'Sentry Ammo', 10},
        {'Metal de Alta', 20},
        {'Grenade Launcher', 8},
        {'Grenade Launcher Ammo', 4},
        {'Rocket Launcher', 20},
        {'Rocket Launcher Ammo', 25},
        {'C4', 25},
        {'Grenade Launcher Ammo:BLUEPRINT', 10},
        {'Satchel', 50},
        {'Grenade', 30},
    },
    ['NO-EXPLOSIVES'] = {
        {'M249', 10},
        {'AK', 20},
        {'AK Ammo:BLUEPRINT', 4},
        {'AK:BLUEPRINT', 4},
        {'LR-300', 28},
        {'Bolt', 30},
        {'Custom SMG', 15},
        {'MP5', 50},
        {'Thompson', 50},
        {'Spas', 20},
        {'M39', 40},
        {'L96', 5},
        {'Revolver', 10},
        {'Scrap Metal', 30},
        {'Vest', 25},
        {'Helmet', 25},
        {'Sentry Ammo', 10},
        {'Metal de Alta', 20},
    },
    ['WIPE'] = {
        {'Bolt', 10},
        {'M249', 10},
        {'M249 Ammo', 10},
        {'Bolt:BLUEPRINT', 10},
        {'Custom SMG', 15},
        {'MP5', 40},
        {'Thompson', 40},
        {'Spas', 40},
        {'M39', 15},
        {'M39 Ammo', 15},
        {'Camera', 15},
        {'Revolver', 10},
        {'Scrap Metal', 30},
        {'Vest', 15},
        {'Helmet', 15},
        {'Radial', 10},
        {'Sentry Ammo', 10},
        {'Metal de Alta', 20},
        {'AK', 20},
        {'LR-300', 20},
        {'LR-300:BLUEPRINT', 4},
        {'LR-300 Ammo', 15},
        {'AK Ammo:BLUEPRINT', 4},
        {'AK:BLUEPRINT', 4},
        {'Rocket Launcher:BLUEPRINT', 4},
        {'Helmet:BLUEPRINT', 4},
        {'Vest:BLUEPRINT', 4},
    },
    ['DEFAULT'] = {
        {'Bolt', 10},
        {'M249', 10},
        {'M249 Ammo', 10},
        {'Bolt:BLUEPRINT', 10},
        {'Custom SMG', 15},
        {'MP5', 40},
        {'Thompson', 40},
        {'Spas', 40},
        {'M39', 15},
        {'M39 Ammo', 15},
        {'Camera', 15},
        {'Revolver', 10},
        {'L96', 10},
        {'Scrap Metal', 30},
        {'Vest', 15},
        {'Helmet', 15},
        {'Radial', 10},
        {'Sentry Ammo', 10},
        {'Metal de Alta', 20},
        {'AK', 20},
        {'LR-300', 20},
        {'LR-300:BLUEPRINT', 4},
        {'LR-300 Ammo', 15},
        {'AK Ammo:BLUEPRINT', 4},
        {'AK:BLUEPRINT', 4},
        {'Rocket Launcher:BLUEPRINT', 4},
        {'Helmet:BLUEPRINT', 4},
        {'Vest:BLUEPRINT', 4},
        {'Grenade Launcher', 10},
        {'Grenade Launcher Ammo', 10},
        {'Rocket Launcher', 3},
        {'Rocket Launcher Ammo', 3},
        {'C4', 4},
        {'Grenade Launcher Ammo:BLUEPRINT', 2},
        {'Satchel', 10},
        {'Grenade', 10},
    },
}
-- LuaFormatter on

-- "LOOT++'' | "NO-EXPLOSIVES" | "DEFAULT" | "WIPE"
local MODE = 'WIPE'

local possibleLoots = POSSIBLE_LOOTS[MODE] or {}

function setDropLoot(ob)
    if isElement(ob) then
        for i, data in ipairs(possibleLoots) do
            local itemName, chance = data[1], data[2]
            if itemName and chance then
                if math.random(100) <= chance then

                    local quantity = exports['gamemode']:getItemMaxSpawnQuantity(itemName) or 0
                    if quantity > 1 then
                        quantity = math.random(quantity / 2, quantity)
                    end

                    setElementData(ob, itemName, (getElementData(ob, itemName) or 0) + quantity)

                    local ammo = exports['gamemode']:getPlayerDataSetting(itemName, 'ammo')
                    if ammo then
                        local quantity = math.random(ammo.magSize / 2, ammo.magSize)
                        setElementData(ob, ammo.name, (getElementData(ob, ammo.name) or 0) + quantity)
                    end

                    local ammo, quantity = exports['gamemode']:getPlayerDataSetting(itemName)
                    if ammo then
                        local quantity = math.random(quantity * 0.5, quantity * 1.5)
                        setElementData(ob, ammo, (getElementData(ob, ammo) or 0) + math.floor(quantity))
                    end

                end
            end
        end
    end
end
